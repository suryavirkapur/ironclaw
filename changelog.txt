0.7.1 2026-02-16
- completed rust-native whatsapp channel wiring in `ironclawd` using `whatsapp-rust`
- added whatsapp auth config keys:
  `whatsapp.session_dir`, `whatsapp.auth_method`, `whatsapp.qr_timeout_ms`
- added backward-compatible config alias:
  `whatsapp.session_db_path` maps to `whatsapp.session_dir`
- added env override:
  `WHATSAPP_SESSION_PATH` for runtime session storage path selection
- implemented startup auth gating with qr/pair timeout handling using `qr_timeout_ms`
- enforced md5 auth selection for whatsapp web login flow (`auth_method = "md5"`)
- added daemon cli parsing/forwarding for channel flags:
  `--whatsapp` and `--telegram`
- added whatsapp message parsing tests for conversation and extended text payloads
- added whatsapp setup documentation:
  `docs/whatsapp_setup.txt` and readme quickstart updates
- added sample `[whatsapp]` sections to host config examples under `configs/`

0.7.0 2026-02-15
- added shared `common::logging` module with levels:
  `noop`, `error`, `warn`, `info`, `debug`, `trace` (default `info`)
- wired host and guest `log_level` config parsing and runtime logging initialization
- added dynamic logging level reload and manual log rotation hooks
- added ironclawd daemon cli flags:
  `--daemon`, `--pid-file <path>`, `--stop`
- implemented pid file lifecycle management with runtime dir fallback to
  `/var/run/ironclaw` or `~/.local/share/ironclaw`
- added daemon signal handling:
  sigterm for graceful shutdown, sighup for config/log level reload, sigusr1 for log rotation
- added host daemon config section with:
  `pid_file`, `log_file`, `graceful_timeout_ms`, `log_rotate_keep`, `log_rotate_max_bytes`
- implemented rotating log file sink with size and daily rotation,
  gzip compression, and rotated-file retention
- added unit tests for log level filtering and integration test for daemon start/stop

0.6.1 2026-02-15
- implemented sqlite blob vector storage in `embeddings(id, chunk_id, vector, model)` with
  pure-sql cosine ranking via registered sqlite scalar functions
- added hybrid retrieval pipeline combining fts5 bm25 and vector similarity with configurable
  weighted fusion (`vector_weight`, `keyword_weight`)
- added sqlite-backed embedding cache with lru + ttl eviction in `embedding_cache`
- upgraded markdown chunking to preserve heading hierarchy and stable chunk ids from
  `(path, heading, ordinal, hash(content))`
- implemented safe reindex operations with atomic fts rebuild, chunk upsert/delete by path,
  and re-embedding of missing vectors
- added like-based fallback search path when embedding generation fails
- added guest indexing config keys: `embedding_model`, `vector_weight`, `keyword_weight`,
  `embedding_cache_size`, and kept backward-compatible aliases for old weight keys
- added memory crate unit tests for sql cosine/vector storage, fusion scoring, lru eviction,
  markdown hierarchy chunking, plus migrated tests to adjacent `_test` file

0.3.2 2026-02-15
- routed whatsapp, telegram, and websocket ingress through owner-keyed agent identity resolution
- completed whatsapp guest routing flow with vm check/start, wake, vsock forward,
  and streamed responses
- added channel routing assertions to verify owner-keyed identity behavior across channels

0.3.1 2026-02-15
- fixed host jobtrigger handling to wake sleeping guest agent, run scheduled job,
  and send jobstatus with debug tracing
- added vm running-state checks to vm manager and host vm spawn logging
- added integration-style test for cron jobtrigger wake+run flow

0.6.0 2026-02-14
- switched guest cron behavior from direct execution to trigger-first dispatch
- scheduler now writes `triggered` state and emits `JobTrigger` events for due jobs
- added guest `run_scheduled_job` execution path so host can start runtime work on demand
- wired host handling for `JobTrigger` to execute scheduled jobs and return `JobStatus`
- added protocol messages for agent lifecycle control (`AgentControl`, `AgentState`)
- implemented guest sleep/wake state persistence at `/mnt/brain/config/agent_state.toml`
- added host `idle_timeout_minutes` config (default `5`) and idle sleep signaling
- added websocket and telegram wake flow integration for user message and cron triggers
- added unit/integration coverage for idle-timeout gating and cron wake-up job flow
- gated `common` firecracker roundtrip example behind `firecracker` feature
  to keep workspace tests green

0.5.0 2026-02-14
- added host soul guard monitor for `soul.md` changes via `crates/ironclawd/src/soul_guard.rs`
- watch targets include `/mnt/brain/soul.md` and per-user guest roots under
  `users_root/<user>/guest/soul.md`
- implemented suspicious diff detection thresholds (`>1024` bytes changed or `>20%` ratio)
- persisted soul change audit logs with `before_hash` and `after_hash` in host sqlite
  (`soul_change_log`)
- added sqlite-backed pending approval queue (`soul_change_approvals`) for suspicious soul diffs
- added host security halt gate in websocket handling when pending soul approvals exist
- added soul guard api endpoints:
  `GET /api/soul-guard/pending` and `POST /api/soul-guard/decision`
- added soul guard unit tests for threshold detection and approval roundtrip behavior
- added guest cron scheduler module at `crates/irowclaw/src/scheduler.rs`
- scheduler reads `/mnt/brain/cron/jobs.toml`, supports 5-field cron expressions, and executes
  tasks in background runtime context
- scheduler writes job execution results to `/logs/YYYY-MM-DD.md`
- scheduler tracks `last_run_ms`, `next_run_ms`, `status`, and `last_result_ref` in sqlite table
  `scheduler_state` for ui querying
- wired scheduler startup into guest runtime loop lifecycle
- added scheduler unit tests for due-job execution/logging and future-job scheduling state

0.4.2 2026-02-13
- enforced telegram guest tool isolation: `guest_tools` and `guest_autonomous` now require
  firecracker runtime and return `Firecracker required for Telegram tool execution` otherwise
- disabled telegram local guest fallback path to prevent in-process `irowclaw` runtime spawn
- added telegram runtime banner on first message per session:
  `running in firecracker vm` or `tools disabled: firecracker not enabled`
- added runtime-gated tool allowlist helper: bash is never offered in local_guest mode
- gated bash exposure in firecracker mode on explicit guest config `tools.allow_bash = true`
- added telegram/firecracker guard tests for local guest rejection and bash allowlist regression
- updated readme telegram quickstart with firecracker isolation requirement and enablement steps

0.4.1 2026-02-13
- added persistent telegram session transcripts under users root at
  `telegram-<chat_id>/telegram.transcript.json`
- stored transcript messages as role/text/timestamp and trimmed to a rolling 50-turn window
- added prompt history injection in host planning/finalization prompts before current user message
- wired telegram transport resilience: detect transport/auth failures, stop vm, restart transport,
  re-auth, and retry once with exponential backoff
- applied the same telegram restart path to firecracker mode via shared `start_vm_pair` and
  `vm_manager.stop_vm(user_id)`
- constrained guest bash tool execution to guest workspace root to preserve guest-only home
  semantics
- added transcript ring-buffer and transcript persistence tests plus prompt-history formatting test
- updated readme telegram quickstart with guest-only home directory, 50-turn context window, and
  transcript storage location

0.4.0 2026-02-13
- added telegram channel mvp in `ironclawd` with long polling via reqwest and outbound
  sendmessage support
- added owner allowlist enforcement via `OWNER_TELEGRAM_CHAT_ID` or
  `[telegram].owner_chat_id`
- added telegram offset persistence at `data/telegram.offset` with load/save helpers and unit
  coverage
- added `--telegram` startup flag and host config `[telegram]` section for token/chat/timeout
  settings
- wired telegram inbound text into existing host-only or guest transport flow with per-chat
  session reuse
- added telegram stream chunking for telegram max message size handling
- added graceful shutdown wiring for http server + telegram loop with shared stop signal
- documented telegram quickstart and test steps in readme
- enabled tokio `signal` feature for ctrl-c shutdown handling

0.3.1 2026-02-13
- added deterministic `TOOLTEST` host planner path for guest_tools mode without llm key dependency
- added `configs/ironclawd.guest-tools.toml` for local guest_tools smoke execution
- updated `smoke-guest-tools-ws` scripts to validate planner-driven guest file tools, policy block,
  and leak detector block with clear pass logs

0.3.0 2026-02-13
- added execution mode config (`host_only`, `guest_tools`, `guest_autonomous`, `auto`)
- extended auth challenge with execution mode for host-guest loop negotiation
- implemented guest safety layer for prompt injection heuristics, policy decisions, and leak checks
- added guest tool registry with allowlist enforcement in `crates/tools`
- implemented real guest `file_read` and `file_write` tools rooted under guest workspace
- wired guest-side `ToolCallRequest` handling to execute tools and return `ToolCallResponse`
- added guest loop support for host-planned mode (`host_plan` internal tool) and autonomous mode
- updated host websocket routing for mode-aware behavior and added `!toolcall <tool>\\n<input>` path
- added unit and protocol integration tests for safety and guest tool execution
- added `scripts/smoke-guest-tools-ws.sh` and `scripts/smoke-guest-tools-ws.mjs`
- documented new execution modes and smoke command usage in readme
- added local guest autonomous host config `configs/ironclawd.guest-autonomous.toml`
- updated firecracker ws config to use `execution_mode = \"guest_tools\"`
- kept step 4 firecracker websocket smoke script compatibility behavior

0.2.2 2026-02-12
- wired websocket user messages to guest transport when firecracker mode is enabled
- added scripts/smoke-firecracker-ws.sh for one-command websocket end-to-end firecracker smoke
- added scripts/smoke-firecracker-ws.mjs client with marker assertion for guest-derived response
- documented firecracker websocket smoke command in readme

0.2.1 2026-02-12
- updated guest rootfs build to emit both directory tree and ext4 image artifact
- added dependency copy handling for busybox and irowclaw when binaries are dynamically linked
- enabled musl-target irowclaw guest build attempt by default for easier static guest runtime
- switched firecracker smoke script to direct host-guest vsock roundtrip example execution
- added firecracker vsock roundtrip example under common crate for smoke validation
- updated firecracker config rootfs path default to rootfs/build/guest-rootfs.ext4
- improved smoke failure diagnostics by tailing firecracker console log

0.2.1 2026-02-13
- added shared long-term memory schema in sqlite (`memories`, `summaries`, `memories_fts`)
- added fts5 retrieval + reranking (recency, importance, pinned) with planner memory block budget
- wired host planner prompts to inject memory block before conversation history and user message
- added background session summarization cadence (every 20 user messages) with durable fact distill
- added memory redaction for key-like strings before persistence
- added guest memory commands: `remember <text>`, `pins`, `forget <id or query>`
- mapped telegram session memory key to global `owner` user id (session still chat-scoped)
- added unit tests for summary cadence, pinned fts retrieval, and key-like redaction

0.2.0 2026-02-11
- added host-only tool planning loop with json plan schema (`tool` or `answer`)
- added plan parsing + validation in llm client with parser unit coverage
- wired host allowlisted tool execution for websocket user turns without guest llm involvement
- added safe tool output truncation and execution logging before llm finalization
- updated todo and agent context for step 2 completion

0.1.2 2026-02-11
- switched ironclawd openai integration from curl subprocess calls to reqwest http client
- kept host-only llm websocket streamdelta flow and cap token auth enforcement intact
- documented step 1 completion detail in todo

0.1.1 2026-02-11
- added host llm config fields for model, base_url, and api selection
- implemented host-only openai llm client in ironclawd using openai_api_key env
- switched websocket user message handling to return host-generated streamdelta responses
- added unit coverage for llm response parsing paths

0.1.0 2026-02-10
- added rust toolchain pin for 1.92.0
- wired firecracker manager selection with feature-gated error handling
- initialized guest brain layout files and jobs.toml scaffolding
- added sqlite vector extension load stub
- tightened websocket timestamp handling without unwraps

0.1.0 2026-02-09
- initial repository scaffolding and workspace layout
- added rustfmt and biome configuration
- created base crates for warden, inmate, and shared modules
- updated agent context with implementation plan
- added common protocol framing, config structs, and transport stubs
- implemented irowclaw runtime scaffolding with config loader and sqlite schema
- implemented memory chunker and sqlite indexer with hybrid retrieval fusion stub
- added tool interfaces with bash and file stubs
- implemented ironclawd axum server with websocket bridge and embedded ui serving
- added ui placeholder assets
- added guest config fallback and ws framing fixes
